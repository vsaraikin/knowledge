# Kafka

## HWM

High Water Mark – оффсет последнего сообщения, которое было реплицировано между всеми репликами партиции. Находится внутри лидерующей реплики партиции

### Как консьюмер узнает о HWM?

Через метадату, которую возвращает брокер, когда консьюмер впервые подключается к топику. Метадата включает в себя:

- текущего лидера
- реплики
- текущий HWM для каждой реплики

## LEO

Log End Offset – оффсет, который был записан в лог партиции. Устанавливается каждой репликой, то есть может различаться в разных репликах.

По-хорошему, они $LEO == HWM$, но на практике, если один брокер страдает, то разница между ними будет говорить о проблеме. 