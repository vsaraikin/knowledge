# Distributed Systems

## 2PC

Двухфазный коммит (2PC, Two-Phase Commit) — это протокол, обеспечивающий атомарность транзакций в распределенных системах. Этот протокол гарантирует, что транзакция будет завершена (зафиксирована или откатана) на всех участниках или ни на одном из них.

Протокол двухфазного коммита состоит из двух фаз:

1. **Фаза подготовки (Prepare phase)**:
    
    - Координатор отправляет запрос на подготовку к коммиту всем участникам транзакции.
    - Каждый участник выполняет все операции транзакции до момента фиксации, но не фиксирует их, и сообщает координатору, готов ли он зафиксировать или нет.
2. **Фаза коммита (Commit phase)**:
    
    - Если все участники сообщили, что готовы к коммиту, координатор отправляет им команду на фиксацию транзакции.
    - Если хотя бы один участник сообщил, что не готов к коммиту, координатор отправляет всем участникам команду на откат транзакции.

Основные компоненты протокола:

- **Координатор (Coordinator)**: Этот компонент контролирует выполнение протокола двухфазного коммита.
- **Участник (Participant)**: Это компоненты, которые участвуют в транзакции и выполняют операции, связанные с транзакцией.

Однако стоит отметить, что двухфазный коммит имеет свои недостатки. Один из основных — это блокировка ресурсов в случае сбоев. Если координатор или один из участников транзакции сталкивается с проблемой (например, отказом), другие участники могут оставаться в заблокированном состоянии на неопределенное время.